<!doctype html>
<html lang="en" class="no-js">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
    <meta name="description" content="A simple, free and easy way to calculate your final grade. GradeCalc
    allows you to save your classes and grades on your account so you don't have to retype them time and time again.">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-69193468-2', 'auto');
        ga('send', 'pageview');
    </script>
    <link rel="stylesheet" href="stylesheets/nav.css">
    <link rel="stylesheet" type="text/css" href="/stylesheets/bootstrap.css">
    <link rel="stylesheet" href="stylesheets/main.css">
    <title>GradeCalc - Your Simple Final Grade Calculator</title>
    <script>
        var user=null,li,classIndexId;function calcluateGrades(){var a=getMarks(),b=getGrades(),c=0,d=0,e=0;makeClassIndexIdNotUndefined();if(a.length==b.length){for(d=0;d<a.length;d++)c+=b[d]/100*a[d],e+=b[d];saveGrades();user[classIndexId].marks=a;user[classIndexId].grades=b}else error();d=c/e*100;isNaN(d)&&(d=0);isNaN(c)&&(c=0);100<e?$("#totalGrade").html("N/A"):$("#totalGrade").html(c.toFixed(2)+"%");$("#currentGrade").html(d.toFixed(2)+"%")}
        function refreshGrades(){var a=getMarks(),b=getGrades(),c=0,d=0,e=0;if(a.length==b.length)for(d=0;d<a.length;d++)c+=b[d]/100*a[d],e+=b[d];else error();d=c/e*100;isNaN(d)&&(d=0);isNaN(c)&&(c=0);100<e?$("#totalGrade").html("N/A"):$("#totalGrade").html(c.toFixed(2)+"%");$("#currentGrade").html(d.toFixed(2)+"%")}function makeClassIndexIdNotUndefined(){void 0==classIndexId&&(classIndexId=0)}function error(){console.log("A grade or mark is missing")}
        function saveGrades(){var a=getMarks(),b=getGrades();$.post("/savegrades",{classIndex:classIndexId,grades:b,marks:a},"json")}function getMarks(){var a=$(".marks"),b=[],c=0;$.each(a,function(a,e){var f=e.value.trim();""!==f&&(b[c]=parseFloat(f));c++});return b}function getGrades(){var a=$(".grades"),b=[],c=0;$.each(a,function(a,e){var f=e.value.trim();""!==f&&(b[c]=parseFloat(f));c++});return b}
        function getUser(){$.ajax({type:"GET",url:"/getUser",contentType:"json",success:function(a){user=a;fillDropdown();classIndexId=0;fillGrades(0)},error:function(a){console.error(a);user=[]}})}function fillDropdown(){for(var a=user,b=document.getElementById("classDropdown"),c=0;c<a.length;c++){var d=a[c].className,e=document.createElement("li");e.id=c;var f=document.createElement("a"),d=document.createTextNode(d);f.appendChild(d);f.href="#";e.appendChild(f);b.appendChild(e)}setDropdown()}
        function clearDropdown(){for(var a=$(".dropdown-menu").children(),b=2;b<a.length;b++)a[b].remove()}function fillGrades(a){var b=user[a].grades,c=user[a].marks;$(".table-row.dynamically-added").remove();if(7<b.length)for(a=7;a<=b.length;a++)addNewRow();addKeyListeners();var d=$(".marks"),e=$(".grades");clearTextBoxes("the-grades");for(a=0;a<b.length;a++)d[a].value=c[a],e[a].value=b[a];refreshGrades()}$(function(){getUser()});
        function setDropdown(){$(".dropdown-menu li a").click(function(){$(this).parents(".dropdown").find(".btn").html($(this).text()+' <span class="caret"></span>');$(this).parents(".dropdown").find(".btn").val($(this).data("value"));var a=this.parentNode.id;classIndexId=parseInt(a);""==a?$("#myModal").modal("show"):(void 0==classIndexId&&(classIndexId=0),fillGrades(classIndexId))})}
        function setVisibleClassInDropdown(a){var b=$(".dropdown-menu li").filter($("#"+a)).children().html();$(".dropdown-menu li a").parents(".dropdown").find(".btn").html(b+' <span class="caret"></span>');classIndexId=a;fillGrades(classIndexId)}
        function addNewClass(){var a=$("#newClassName").val();$.ajax({type:"POST",url:"/addNewClass",dataType:"json",contentType:"application/json; charset=UTF-8",data:JSON.stringify({className:a}),success:function(a){}});$("#myModal").modal("hide");$("#newClassName").val("");user.push({className:a,grades:[],marks:[]});clearDropdown();fillDropdown();setVisibleClassInDropdown(user.length-1)}
        function addKeyListeners(){var a=$(".form-control"),b=a[a.length-3],c=!1;a.off("keypress");$(b).keypress(function(){0==c&&(addNewRow(),c=!0,addKeyListeners())})}$(window).load(function(){addKeyListeners();var a=$(".main-nav");a.on("click",function(b){$(b.target).is(a)&&a.children("ul").toggleClass("is-visible")});$(document).keypress(function(a){13==a.which&&$("#markButton").click()})});function confirmDelete(a){confirm("Are you sure you want to delete this class?")&&deleteClass(a)}
        function deleteClass(a){$.ajax({type:"POST",url:"/deleteclass",dataType:"json",contentType:"application/json; charset=UTF-8",data:JSON.stringify({classIndex:a}),success:function(a){}});user.splice(a,1);clearDropdown();fillDropdown();setVisibleClassInDropdown(0)}
        function addNewRow(){var a;a='<div class="table-row dynamically-added">                    <div class="table-cell"> <input type="text" class="marks form-control" maxlength="8" > </div>';a+='<div class="table-cell"> <input type="text" class="grades form-control" maxlength="8" > </div>';a+="</div>";$("#table-of-grades").append(a)}function clearTextBoxes(a){$("#"+a).find("input:text").each(function(){$(this).val("")})};
    </script>
</head>
<body>
<header role="banner">
    <!--<div id="cd-logo"><a href="#0"><img src="img/cd-logo.svg" alt="Logo"></a></div>-->
    <div id="cd-logo"><h1 href="/" style="color: ghostwhite; margin-top: auto">GradeCalc.co</h1></div>
    <nav class="main-nav">
        <ul>
            <li><a class="cd-signin" onclick="confirmDelete(classIndexId)" id="deleteClassButton">Delete this class</a></li>
            <li><a class="cd-signup" href="/logout">Log out</a></li>
        </ul>
    </nav>
</header>
<div class="alert alert-info text-center" id="welcome-back" role="alert"> </div>

<div class="container-fluid">
    <div class="row no-gutter">
        <div class="col-xs-12 text-center">
            <div id="content">

                <div class="table-row">
                    <div class="table-button">
                        <div class="dropdown">
                            <button class="btn btn-default dropdown-toggle btn-block" type="button" id="dropdownMenu2" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Select your class
                                <span class="caret"></span>
                            </button>
                            <ul id="classDropdown" class="dropdown-menu btn-block" aria-labelledby="dropdownMenu2">
                                <li><a href="#">Add class</a></li>
                                <li role="separator" class="divider"></li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div id="the-grades">
                    <div id="table-of-grades">
                        <div class="table-row">
                            <div class="table-cell"><h4 class="text-center">Your Grade</h4> </div>
                            <div class="table-cell"> <h4 class="text-center">Weight</h4> </div>
                        </div>
                        <div class="table-row">
                            <div class="table-cell"><input type="text" class="marks form-control" id="mark1" maxlength="8" placeholder="ex 75"> </div>
                            <div class="table-cell"> <input type="text" class="grades form-control" id="grade1" maxlength="8" placeholder="ex 50"> </div>
                        </div>
                        <div class="table-row">
                            <div class="table-cell"> <input type="text" class="marks form-control" id="mark2" maxlength="8"  placeholder="ex 88"> </div>
                            <div class="table-cell"> <input type="text" class="grades form-control" id="grade2" maxlength="8"  placeholder="ex 30"> </div>
                        </div>
                        <div class="table-row">
                            <div class="table-cell"> <input type="text" class="marks form-control" id="mark3" maxlength="8" placeholder="ex 91.23"></div>
                            <div class="table-cell"> <input type="text" class="grades form-control" id="grade3" maxlength="8" placeholder="ex 5"></div>
                        </div>
                        <div class="table-row">
                            <div class="table-cell"> <input type="text" class="marks form-control" id="mark4" maxlength="8" > </div>
                            <div class="table-cell"> <input type="text" class="grades form-control" id="grade4" maxlength="8" > </div>
                        </div>
                        <div class="table-row">
                            <div class="table-cell"> <input type="text" class="marks form-control" id="mark5" maxlength="8" > </div>
                            <div class="table-cell"> <input type="text" class="grades form-control" id="grade5" maxlength="8" > </div>
                        </div>
                        <div class="table-row">
                            <div class="table-cell"> <input type="text" class="marks form-control" id="mark6" maxlength="8" > </div>
                            <div class="table-cell"> <input type="text" class="grades form-control" id="grade6" maxlength="8" > </div>
                        </div>
                        <div class="table-row">
                            <div class="table-cell"> <input type="text" class="marks form-control" maxlength="8" > </div>
                            <div class="table-cell"> <input type="text" class="grades form-control" maxlength="8" > </div>
                        </div>
                    </div>
                    <div class="table-row">
                        <div class="table-button"> <button type="button" id="markButton" onclick="calcluateGrades()" class="btn btn-default btn-block">What's my mark?</button> </div>
                    </div>
                    <div class="table-row" >
                        <div class="table-cell"> <h4 class="text-left" >Current grade:</h4> </div>
                        <div class="table-cell"> <h4 class="text-right" id="currentGrade"> 0.00%</h4> </div>
                    </div>
                    <div class="table-row" >
                        <div class="table-cell"> <h4 class="text-left" > Final grade: </h4> </div>
                        <div class="table-cell"> <h4 class="text-right" id="totalGrade"> 0.00% </h4> </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    &nbsp;
</div>
<!--<footer>
    <h6 class="text-left" style="padding-left: 1%; padding-top: 1%"></h6>
</footer>-->
<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">Add a new class</h4>
            </div>
            <div class="modal-body">
                <div class="table-row some-margin">
                    <div class="col-sm-3"> <h5>Class name/code: </h5> </div>
                    <div class="col-sm-4"> <input type="text" class="form-control" id="newClassName" > </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" id="newClassButton" onclick="addNewClass()">Add new class</button>
            </div>
        </div>
    </div>
</div>
</body>
</html>

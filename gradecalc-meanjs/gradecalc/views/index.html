<!doctype html>
<html lang="en" class="no-js">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
    <meta name="description" content="A simple, free and easy way to calculate your final grade. GradeCalc
    allows you to save your classes and grades on your account so you don't have to retype them time and time again.">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-69193468-2', 'auto');
        ga('send', 'pageview');

    </script>
    <link rel="stylesheet" href="stylesheets/nav.css">
    <link rel="stylesheet" type="text/css" href="/stylesheets/bootstrap.css">
    <link rel="stylesheet" href="stylesheets/main.css">

    <title>GradeCalc - Your Simple Final Grade Calculator</title>

    <script>

        /* GLOBAL VARIABLES */
        var user = [];
        var li;
        /* GLOBAL VARIABLES */

        function calcluateGrades() {
            var marks = getMarks();
            var grades = getGrades();
            var totalGrade = 0;
            var currentGrade = 0;
            var totalGradeAvailible = 0;
            // calculate total grade
            if (marks.length == grades.length) {
                for(var i = 0; i < marks.length; i++)  {
                    totalGrade = totalGrade + (marks[i] * (grades[i]/100));
                    totalGradeAvailible += grades[i];
                }
            }
            else {
                error();
            }
            // calculate current grade
            currentGrade = totalGrade/totalGradeAvailible;
            currentGrade = currentGrade*100;
            if(isNaN(currentGrade)) { currentGrade = 0; }
            if(isNaN(totalGrade)) { totalGrade = 0; }
            if(totalGradeAvailible > 100)   {
                $("#totalGrade").html("N/A");
            }
            else    {
                $("#totalGrade").html(totalGrade.toFixed(2) + "%");
            }
            $("#currentGrade").html(currentGrade.toFixed(2) + "%");

        }

        function error()  {
            console.log("A grade or mark is missing");
        }


        // TODO: these functions need to be generalized
        function getMarks() {
            var arrayOfMarks = $(".marks");
            var marks = [];
            var x = 0;
            $.each(arrayOfMarks , function(index, value){
                var trimedValue = value.value.trim();
                if (trimedValue !== "")  {
                    marks[x] = parseFloat(trimedValue);
                }
                x++;
            });
            return marks;
        }

        function getGrades() {
            var arrayOfGrades = $(".grades");
            var grades = [];
            var x = 0;
            $.each(arrayOfGrades , function(index, value){
                var trimedValue = value.value.trim();
                if (trimedValue !== "")  {
                    grades[x] = parseFloat(trimedValue);
                }
                x++;
            });
            return grades;
        }

        function addNewRow()    {
            var strVar="";
            strVar += "<div class=\"table-row\">";
            strVar += "                    <div class=\"table-cell\"> <input type=\"text\" class=\"marks form-control\" maxlength=\"8\" > <\/div>";
            strVar += "<div class=\"table-cell\"> <input type=\"text\" class=\"grades form-control\" maxlength=\"8\" > <\/div>";
            strVar += "<\/div>";
            var tableOfGrades = $('#table-of-grades');
            tableOfGrades.append(strVar);
        }

        function addKeyListeners()  {
            var inputs = $('.form-control');
            var lastGradeInput = inputs[inputs.length - 2];
            var alreadyAdded = false;
            inputs.off('keypress');
            // each time a key is pressed I need to check if it was the last one and if it is, then
            // call addNewRow()
            $(lastGradeInput).keypress(function() {
                if(alreadyAdded == false)   {
                    addNewRow();
                    alreadyAdded = true;
                    addKeyListeners();
                }
            });
        }

        $(window).load(function(){
            addKeyListeners();

            // Mobile menu dropdown
            var mainNav = $('.main-nav');
            mainNav.on('click', function(event){
                $(event.target).is(mainNav) && mainNav.children('ul').toggleClass('is-visible');
            });

            // enter key now presses the mark button
            $(document).keypress(function(e){
                if (e.which == 13){
                    $("#markButton").click();
                }
            });

        });

        function clearTextBoxes(divID)  {
            $('#' + divID).find('input:text').each(function() {
                        $(this).val('');
                    }
            );
        }
    </script>


</head>
<body>
<div id="fb-root"></div>
<script>(function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.5&appId=309315865755199";
    fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<header role="banner">
    <!--<div id="cd-logo"><a href="#0"><img src="img/cd-logo.svg" alt="Logo"></a></div>-->
    <div id="cd-logo"><h1 href="/" style="color: ghostwhite; margin-top: auto">GradeCalc.co</h1></div>
    <nav class="main-nav">
        <ul>
            <li><a class="cd-signin" href="/login">Sign in</a></li>
            <li><a class="cd-signup" href="/register">Sign up</a></li>
        </ul>
    </nav>
</header>
<div class="alert alert-info text-center" role="alert"> Create an account to save your grades and classes! </div>
&nbsp;
<div class="container-fluid">
    <div class="row no-gutter">
        <div class="col-xs-12 text-center">
            <div id="content">
                <div id="table-of-grades">
                    <div class="table-row">
                        <div class="table-cell"> <h4 class="text-center">Your Grade</h4> </div>
                        <div class="table-cell"> <h4 class="text-center">Weight</h4> </div>
                    </div>
                    <div class="table-row">
                        <div class="table-cell"> <input type="text" class="marks form-control" id="mark1" maxlength="8" placeholder="ex 75.6"> </div>
                        <div class="table-cell"> <input type="text" class="grades form-control" id="grade1" maxlength="8" placeholder="ex 50"> </div>
                    </div>
                    <div class="table-row">
                        <div class="table-cell"> <input type="text" class="marks form-control" id="mark2" maxlength="8"  placeholder="ex 88"> </div>
                        <div class="table-cell"> <input type="text" class="grades form-control" id="grade2" maxlength="8"  placeholder="ex 30"> </div>
                    </div>
                    <div class="table-row">
                        <div class="table-cell"> <input type="text" class="marks form-control" id="mark3" maxlength="8" placeholder="ex 91.23"></div>
                        <div class="table-cell"> <input type="text" class="grades form-control" id="grade3" maxlength="8" placeholder="ex 5"></div>
                    </div>
                    <div class="table-row">
                        <div class="table-cell"> <input type="text" class="marks form-control" id="mark4" maxlength="8" > </div>
                        <div class="table-cell"> <input type="text" class="grades form-control" id="grade4" maxlength="8" > </div>
                    </div>
                    <div class="table-row">
                        <div class="table-cell"> <input type="text" class="marks form-control" id="mark5" maxlength="8" > </div>
                        <div class="table-cell"> <input type="text" class="grades form-control" id="grade5" maxlength="8" > </div>
                    </div>
                    <div class="table-row">
                        <div class="table-cell"> <input type="text" class="marks form-control" id="mark6" maxlength="8" > </div>
                        <div class="table-cell"> <input type="text" class="grades form-control" id="grade6" maxlength="8" > </div>
                    </div>
                    <div class="table-row">
                        <div class="table-cell"> <input type="text" class="marks form-control" maxlength="8" > </div>
                        <div class="table-cell"> <input type="text" class="grades form-control" maxlength="8" > </div>
                    </div>
                </div>
                <div class="table-row">
                    <div class="table-button"> <button type="button" id="markButton" onclick="calcluateGrades()" class="btn btn-default btn-block">What's my mark?</button> </div>
                </div>
                <div class="table-row" >
                    <div class="table-cell"> <h4 class="text-left" >Current grade:</h4> </div>
                    <div class="table-cell"> <h4 class="text-right" id="currentGrade"> 0.00%</h4> </div>
                </div>
                <div class="table-row" >
                    <div class="table-cell"> <h4 class="text-left" > Total grade: </h4> </div>
                    <div class="table-cell"> <h4 class="text-right" id="totalGrade"> 0.00% </h4> </div>
                </div>
            </div>
        </div>
    </div>
    &nbsp;
</div>
<!--<footer>
    <h6 class="text-left" style="padding-left: 1%; padding-top: 1%"></h6>
</footer>-->
<div class="fb-share-button" data-href="http://www.gradecalc.co" data-layout="button_count"></div>
</body>
</html>
